<!DOCTYPE html>
<html>
<body>
<p id="msg">Redirecting...</p>

<script>
const msg = document.getElementById("msg");
const code = new URLSearchParams(location.search).get("c");

if(!code){
  msg.innerText = "Code missing";
  throw "";
}

const DB =
"https://linksnapp-405bb-default-rtdb.asia-southeast1.firebasedatabase.app/links/"+code+".json";

fetch(DB)
.then(r => r.json())
.then(d => {
  if(!d){
    msg.innerText = "No data in Firebase";
    return;
  }
  if(!d.url){
    msg.innerText = "URL field missing";
    return;
  }

  msg.innerText = "Redirecting to original...";
  location.href = d.url;
})
.catch(err=>{
  msg.innerText = "Fetch error";
});
</script>
</body>
</html>

